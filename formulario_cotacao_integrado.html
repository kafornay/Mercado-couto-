<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  <meta charset="UTF-8" />
Â  <title>CotaÃ§Ã£o - Mercado Couto</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  background: #f9f9f9;
Â  Â  Â  padding: 10px;
Â  Â  Â  margin: 0;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  height: 100vh;
Â  Â  Â  overflow: auto;
Â  Â  }

Â  Â  .container {
Â  Â  Â  max-width: 650px;
Â  Â  Â  width: 100%;
Â  Â  Â  background: #fff;
Â  Â  Â  padding: 20px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
Â  Â  Â  overflow-y: auto;
Â  Â  Â  max-height: 90vh;
Â  Â  Â  padding-bottom: 120px; /* espaÃ§o pro botÃ£o fixo */
Â  Â  }

Â  Â  h1 {
Â  Â  Â  text-align: center;
Â  Â  Â  color: #d35400;
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  font-size: 1.8rem;
Â  Â  Â  text-transform: uppercase;
Â  Â  }

Â  Â  .field {
Â  Â  Â  margin-bottom: 15px;
Â  Â  }

Â  Â  label {
Â  Â  Â  font-weight: bold;
Â  Â  Â  display: block;
Â  Â  Â  margin-bottom: 5px;
Â  Â  }

Â  Â  input, select {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 12px;
Â  Â  Â  font-size: 1rem;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  box-sizing: border-box;
Â  Â  }

Â  Â  button {
Â  Â  Â  padding: 14px;
Â  Â  Â  font-size: 1rem;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  width: 100%;
Â  Â  Â  box-sizing: border-box;
Â  Â  Â  transition: background-color 0.3s ease;
Â  Â  }

Â  Â  #addItem {
Â  Â  Â  background-color: #d35400;
Â  Â  Â  color: white;
Â  Â  Â  margin-top: 10px;
Â  Â  }

Â  Â  #addItem:hover {
Â  Â  Â  background-color: #e67e22;
Â  Â  }

Â  Â  table {
Â  Â  Â  width: 100%;
Â  Â  Â  border-collapse: collapse;
Â  Â  Â  margin-top: 20px;
Â  Â  Â  font-size: 0.95rem;
Â  Â  }

Â  Â  th, td {
Â  Â  Â  padding: 10px;
Â  Â  Â  border: 1px solid #ddd;
Â  Â  Â  text-align: left;
Â  Â  }

Â  Â  th {
Â  Â  Â  background-color: #f3f3f3;
Â  Â  Â  color: #333;
Â  Â  }

Â  Â  tbody tr {
Â  Â  Â  background-color: #fafafa;
Â  Â  Â  animation: fadeIn 0.3s ease-in-out; /* animaÃ§Ã£o ao adicionar item */
Â  Â  }

Â  Â  tbody tr:hover {
Â  Â  Â  background-color: #f1f1f1;
Â  Â  }

Â  Â  .removeBtn {
Â  Â  Â  color: #e74c3c;
Â  Â  Â  font-weight: bold;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  background: none;
Â  Â  Â  border: none;
Â  Â  Â  padding: 0;
Â  Â  Â  margin-left: 10px;
Â  Â  Â  transition: color 0.3s ease;
Â  Â  }

Â  Â  .removeBtn:hover {
Â  Â  Â  color: #c0392b;
Â  Â  }

Â  Â  #totalDisplay {
Â  Â  Â  margin-top: 10px;
Â  Â  Â  text-align: right;
Â  Â  Â  font-weight: bold;
Â  Â  Â  color: #2c3e50;
Â  Â  }

Â  Â  #sendData {
Â  Â  Â  position: fixed;
Â  Â  Â  bottom: 20px;
Â  Â  Â  left: 50%;
Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  background-color: #25D366;
Â  Â  Â  color: white;
Â  Â  Â  font-weight: bold;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 30px;
Â  Â  Â  padding: 14px 24px;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  gap: 10px;
Â  Â  Â  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
Â  Â  Â  z-index: 1000;
Â  Â  }

Â  Â  #sendData:hover {
Â  Â  Â  background-color: #20ba5a;
Â  Â  }

Â  Â  @keyframes fadeIn {
Â  Â  Â  from { opacity: 0; transform: translateY(10px); }
Â  Â  Â  to { opacity: 1; transform: translateY(0); }
Â  Â  }

Â  Â  @media (max-width: 480px) {
Â  Â  Â  input, select, button {
Â  Â  Â  Â  font-size: 1rem;
Â  Â  Â  Â  padding: 12px;
Â  Â  Â  }

Â  Â  Â  table, thead, tbody, th, td, tr {
Â  Â  Â  Â  display: block;
Â  Â  Â  Â  width: 100%;
Â  Â  Â  }

Â  Â  Â  tr {
Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  }

Â  Â  Â  th {
Â  Â  Â  Â  background: none;
Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  }

Â  Â  Â  td {
Â  Â  Â  Â  padding: 5px 0;
Â  Â  Â  }

Â  Â  Â  #totalDisplay {
Â  Â  Â  Â  text-align: center;
Â  Â  Â  }
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="container">
Â  Â  <h1>ðŸ›’ CotaÃ§Ã£o - Mercado Couto</h1>

Â  Â  <div class="field">
Â  Â  Â  <label for="empresa">Nome da Empresa:</label>
Â  Â  Â  <input type="text" id="empresa" placeholder="Digite o nome da sua empresa" required />
Â  Â  </div>

Â  Â  <div class="field">
Â  Â  Â  <label for="dataEntrega">Data de Entrega:</label>
Â  Â  Â  <input type="date" id="dataEntrega" required />
Â  Â  </div>

Â  Â  <div class="field">
Â  Â  Â  <label for="produto">Produto:</label>
Â  Â  Â  <select id="produto"></select>
Â  Â  </div>

Â  Â  <div class="field">
Â  Â  Â  <label for="marca">Marca:</label>
Â  Â  Â  <input type="text" id="marca" placeholder="Digite a marca" />
Â  Â  </div>

Â  Â  <div class="field">
Â  Â  Â  <label for="quantidade">Quantidade:</label>
Â  Â  Â  <input type="number" id="quantidade" placeholder="Ex: 30" />
Â  Â  </div>

Â  Â  <div class="field">
Â  Â  Â  <label for="valor">Valor unitÃ¡rio (R$):</label>
Â  Â  Â  <input type="number" id="valor" step="0.01" placeholder="Ex: 4.65" />
Â  Â  </div>

Â  Â  <button id="addItem">+ Adicionar Ã  Lista</button>

Â  Â  <table id="listaItens">
Â  Â  Â  <thead>
Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  <th>Produto</th>
Â  Â  Â  Â  Â  <th>Marca</th>
Â  Â  Â  Â  Â  <th>Qtd</th>
Â  Â  Â  Â  Â  <th>Total (R$)</th>
Â  Â  Â  Â  Â  <th>Remover</th>
Â  Â  Â  Â  </tr>
Â  Â  Â  </thead>
Â  Â  Â  <tbody></tbody>
Â  Â  </table>

Â  Â  <div id="totalDisplay"></div>
Â  </div>

Â  <button id="sendData">
Â  Â  <img src="https://img.icons8.com/ios-filled/24/ffffff/whatsapp.png" alt="WhatsApp" style="width: 20px; height: 20px;" />
Â  Â  Enviar via WhatsApp
Â  </button>

Â  <script>
Â  Â  const produtoSelect = document.getElementById("produto");
Â  Â  const addItemBtn = document.getElementById("addItem");
Â  Â  const listaItens = document.getElementById("listaItens").getElementsByTagName('tbody')[0];
Â  Â  const sendDataBtn = document.getElementById("sendData");
Â  Â  const totalDisplay = document.getElementById("totalDisplay");

Â  Â  let itens = JSON.parse(localStorage.getItem('itens')) || [];

Â  Â  const apiUrl = "https://script.google.com/macros/s/AKfycbxLJAKDj6xrk2pZK2Kst6hGKQZO4OAXx9ZKZIzuT3Qs1Oxv1fKsbpFTQKWTLkLd7DtA7A/exec";

Â  Â  fetch(apiUrl)
Â  Â  Â  .then(res => res.json())
Â  Â  Â  .then(data => {
Â  Â  Â  Â  data.forEach(item => {
Â  Â  Â  Â  Â  const option = document.createElement("option");
Â  Â  Â  Â  Â  option.textContent = item.Produto || item.produto;
Â  Â  Â  Â  Â  produtoSelect.appendChild(option);
Â  Â  Â  Â  });
Â  Â  Â  })
Â  Â  Â  .catch(err => {
Â  Â  Â  Â  console.error("Erro ao carregar produtos:", err);
Â  Â  Â  Â  produtoSelect.innerHTML = '<option>Erro ao carregar</option>';
Â  Â  Â  });

Â  Â  function renderLista() {
Â  Â  Â  listaItens.innerHTML = "";
Â  Â  Â  let total = 0;

Â  Â  Â  itens.forEach((item, index) => {
Â  Â  Â  Â  const subtotal = parseFloat(item.valor) * parseFloat(item.quantidade);
Â  Â  Â  Â  total += subtotal;

Â  Â  Â  Â  const row = listaItens.insertRow();
Â  Â  Â  Â  row.innerHTML = `
Â  Â  Â  Â  Â  <td>${item.produto}</td>
Â  Â  Â  Â  Â  <td>${item.marca}</td>
Â  Â  Â  Â  Â  <td>${item.quantidade}</td>
Â  Â  Â  Â  Â  <td>R$ ${subtotal.toFixed(2)}</td>
Â  Â  Â  Â  Â  <td><button class="removeBtn">X</button></td>
Â  Â  Â  Â  `;

Â  Â  Â  Â  row.querySelector(".removeBtn").addEventListener("click", () => {
Â  Â  Â  Â  Â  itens.splice(index, 1);
Â  Â  Â  Â  Â  localStorage.setItem('itens', JSON.stringify(itens));
Â  Â  Â  Â  Â  renderLista();
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  totalDisplay.textContent = `Total: R$ ${total.toFixed(2)}`;

Â  Â  Â  listaItens.lastChild.scrollIntoView({ behavior: "smooth" }); // move a pÃ¡gina atÃ© o Ãºltimo item adicionado
Â  Â  }

Â  Â  addItemBtn.addEventListener("click", () => {
Â  Â  Â  const produto = produtoSelect.value;
Â  Â  Â  const marca = document.getElementById("marca").value;
Â  Â  Â  const quantidade = document.getElementById("quantidade").value;
Â  Â  Â  const valor = document
